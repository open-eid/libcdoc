<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libcdoc: libcdoc::PKCS11Backend Struct Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">libcdoc<span id="projectnumber">&#160;0.1.8</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('structlibcdoc_1_1PKCS11Backend.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="structlibcdoc_1_1PKCS11Backend-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">libcdoc::PKCS11Backend Struct Reference</div></div>
</div><!--header-->
<div class="contents">

<p>A convenience class for PKCS11 based cryptographic operations.  
 <a href="structlibcdoc_1_1PKCS11Backend.html#details">More...</a></p>

<p><code>#include &lt;PKCS11Backend.h&gt;</code></p>

<p>Inherits <a class="el" href="structlibcdoc_1_1CryptoBackend.html">libcdoc::CryptoBackend</a>.</p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structlibcdoc_1_1PKCS11Backend_1_1Handle.html">Handle</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a74885b986a6a2897b3ac85ee24e5b87a" id="r_a74885b986a6a2897b3ac85ee24e5b87a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structlibcdoc_1_1PKCS11Backend.html#a74885b986a6a2897b3ac85ee24e5b87a">PKCS11Backend</a> (const std::string &amp;path)</td></tr>
<tr class="memdesc:a74885b986a6a2897b3ac85ee24e5b87a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct a new <a class="el" href="structlibcdoc_1_1PKCS11Backend.html" title="A convenience class for PKCS11 based cryptographic operations.">PKCS11Backend</a> object.  <br /></td></tr>
<tr class="separator:a74885b986a6a2897b3ac85ee24e5b87a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8cd9cf09516cd59c65eb0d5287d56687" id="r_a8cd9cf09516cd59c65eb0d5287d56687"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structlibcdoc_1_1PKCS11Backend.html#a8cd9cf09516cd59c65eb0d5287d56687">~PKCS11Backend</a> ()</td></tr>
<tr class="separator:a8cd9cf09516cd59c65eb0d5287d56687"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17ab0ce43dc28ec18ef2c5147f3b4508" id="r_a17ab0ce43dc28ec18ef2c5147f3b4508"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structlibcdoc_1_1PKCS11Backend_1_1Handle.html">Handle</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structlibcdoc_1_1PKCS11Backend.html#a17ab0ce43dc28ec18ef2c5147f3b4508">findCertificates</a> (const std::string &amp;label)</td></tr>
<tr class="memdesc:a17ab0ce43dc28ec18ef2c5147f3b4508"><td class="mdescLeft">&#160;</td><td class="mdescRight">find all certificates with given label  <br /></td></tr>
<tr class="separator:a17ab0ce43dc28ec18ef2c5147f3b4508"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e7bcd109cd8b21362a35bcfb04a1cbb" id="r_a9e7bcd109cd8b21362a35bcfb04a1cbb"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structlibcdoc_1_1PKCS11Backend_1_1Handle.html">Handle</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structlibcdoc_1_1PKCS11Backend.html#a9e7bcd109cd8b21362a35bcfb04a1cbb">findCertificates</a> (const std::vector&lt; uint8_t &gt; &amp;public_key)</td></tr>
<tr class="memdesc:a9e7bcd109cd8b21362a35bcfb04a1cbb"><td class="mdescLeft">&#160;</td><td class="mdescRight">find all certificates for given public key  <br /></td></tr>
<tr class="separator:a9e7bcd109cd8b21362a35bcfb04a1cbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa75431d2b7a367dd84fc99883667628a" id="r_aa75431d2b7a367dd84fc99883667628a"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structlibcdoc_1_1PKCS11Backend_1_1Handle.html">Handle</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structlibcdoc_1_1PKCS11Backend.html#aa75431d2b7a367dd84fc99883667628a">findSecretKeys</a> (const std::string &amp;label)</td></tr>
<tr class="memdesc:aa75431d2b7a367dd84fc99883667628a"><td class="mdescLeft">&#160;</td><td class="mdescRight">find all secret keys with given label  <br /></td></tr>
<tr class="separator:aa75431d2b7a367dd84fc99883667628a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4bcd34cdd3463087935cf7c78a0b80c" id="r_ac4bcd34cdd3463087935cf7c78a0b80c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibcdoc.html#abb349a8d9c0b8304470646b4080142c3">result_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structlibcdoc_1_1PKCS11Backend.html#ac4bcd34cdd3463087935cf7c78a0b80c">useSecretKey</a> (int slot, const std::vector&lt; uint8_t &gt; &amp;pin, const std::vector&lt; uint8_t &gt; &amp;id, const std::string &amp;label)</td></tr>
<tr class="memdesc:ac4bcd34cdd3463087935cf7c78a0b80c"><td class="mdescLeft">&#160;</td><td class="mdescRight">load secret key  <br /></td></tr>
<tr class="separator:ac4bcd34cdd3463087935cf7c78a0b80c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada4f66fba5fe24208239331fedf6ba12" id="r_ada4f66fba5fe24208239331fedf6ba12"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibcdoc.html#abb349a8d9c0b8304470646b4080142c3">result_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structlibcdoc_1_1PKCS11Backend.html#ada4f66fba5fe24208239331fedf6ba12">usePrivateKey</a> (int slot, const std::vector&lt; uint8_t &gt; &amp;pin, const std::vector&lt; uint8_t &gt; &amp;id, const std::string &amp;label)</td></tr>
<tr class="memdesc:ada4f66fba5fe24208239331fedf6ba12"><td class="mdescLeft">&#160;</td><td class="mdescRight">loads private key  <br /></td></tr>
<tr class="separator:ada4f66fba5fe24208239331fedf6ba12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a25d323c8c4c0d2bed8aec9345c560f" id="r_a8a25d323c8c4c0d2bed8aec9345c560f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibcdoc.html#abb349a8d9c0b8304470646b4080142c3">result_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structlibcdoc_1_1PKCS11Backend.html#a8a25d323c8c4c0d2bed8aec9345c560f">getCertificate</a> (std::vector&lt; uint8_t &gt; &amp;val, bool &amp;rsa, int slot, const std::vector&lt; uint8_t &gt; &amp;pin, const std::vector&lt; uint8_t &gt; &amp;id, const std::string &amp;label)</td></tr>
<tr class="memdesc:a8a25d323c8c4c0d2bed8aec9345c560f"><td class="mdescLeft">&#160;</td><td class="mdescRight">get certificate value  <br /></td></tr>
<tr class="separator:a8a25d323c8c4c0d2bed8aec9345c560f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf49cdf8293066360fcddc7b66efa2df" id="r_aaf49cdf8293066360fcddc7b66efa2df"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibcdoc.html#abb349a8d9c0b8304470646b4080142c3">result_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structlibcdoc_1_1PKCS11Backend.html#aaf49cdf8293066360fcddc7b66efa2df">getPublicKey</a> (std::vector&lt; uint8_t &gt; &amp;val, bool &amp;rsa, int slot, const std::vector&lt; uint8_t &gt; &amp;pin, const std::vector&lt; uint8_t &gt; &amp;id, const std::string &amp;label)</td></tr>
<tr class="memdesc:aaf49cdf8293066360fcddc7b66efa2df"><td class="mdescLeft">&#160;</td><td class="mdescRight">get public key value  <br /></td></tr>
<tr class="separator:aaf49cdf8293066360fcddc7b66efa2df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfe309c8bad55fb7578b72051acd58a7" id="r_acfe309c8bad55fb7578b72051acd58a7"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacelibcdoc.html#abb349a8d9c0b8304470646b4080142c3">result_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structlibcdoc_1_1PKCS11Backend.html#acfe309c8bad55fb7578b72051acd58a7">connectToKey</a> (int idx, bool priv)</td></tr>
<tr class="memdesc:acfe309c8bad55fb7578b72051acd58a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">loads key for encryption/decryption  <br /></td></tr>
<tr class="separator:acfe309c8bad55fb7578b72051acd58a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6895f5e16312d11c19bac659b229c309" id="r_a6895f5e16312d11c19bac659b229c309"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacelibcdoc.html#abb349a8d9c0b8304470646b4080142c3">result_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structlibcdoc_1_1PKCS11Backend.html#a6895f5e16312d11c19bac659b229c309">usePSS</a> (int idx)</td></tr>
<tr class="memdesc:a6895f5e16312d11c19bac659b229c309"><td class="mdescLeft">&#160;</td><td class="mdescRight">whether to use PSS RSA padding  <br /></td></tr>
<tr class="separator:a6895f5e16312d11c19bac659b229c309"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd6134ab368917d7b061ff0c11b96f71" id="r_acd6134ab368917d7b061ff0c11b96f71"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacelibcdoc.html#abb349a8d9c0b8304470646b4080142c3">result_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structlibcdoc_1_1PKCS11Backend.html#acd6134ab368917d7b061ff0c11b96f71">deriveECDH1</a> (std::vector&lt; uint8_t &gt; &amp;dst, const std::vector&lt; uint8_t &gt; &amp;public_key, unsigned int idx) override</td></tr>
<tr class="memdesc:acd6134ab368917d7b061ff0c11b96f71"><td class="mdescLeft">&#160;</td><td class="mdescRight">Derive shared secret.  <br /></td></tr>
<tr class="separator:acd6134ab368917d7b061ff0c11b96f71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64513a6ead8c69232e1285efd58ba64b" id="r_a64513a6ead8c69232e1285efd58ba64b"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacelibcdoc.html#abb349a8d9c0b8304470646b4080142c3">result_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structlibcdoc_1_1PKCS11Backend.html#a64513a6ead8c69232e1285efd58ba64b">decryptRSA</a> (std::vector&lt; uint8_t &gt; &amp;dst, const std::vector&lt; uint8_t &gt; &amp;data, bool oaep, unsigned int idxl) override</td></tr>
<tr class="memdesc:a64513a6ead8c69232e1285efd58ba64b"><td class="mdescLeft">&#160;</td><td class="mdescRight">decryptRSA  <br /></td></tr>
<tr class="separator:a64513a6ead8c69232e1285efd58ba64b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b99eee8890b03e1c3a508c24ff3b02f" id="r_a4b99eee8890b03e1c3a508c24ff3b02f"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacelibcdoc.html#abb349a8d9c0b8304470646b4080142c3">result_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structlibcdoc_1_1PKCS11Backend.html#a4b99eee8890b03e1c3a508c24ff3b02f">extractHKDF</a> (std::vector&lt; uint8_t &gt; &amp;kek, const std::vector&lt; uint8_t &gt; &amp;salt, const std::vector&lt; uint8_t &gt; &amp;pw_salt, int32_t kdf_iter, unsigned int idx) override</td></tr>
<tr class="memdesc:a4b99eee8890b03e1c3a508c24ff3b02f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get CDoc2 KEK pre-master from symmetric key.  <br /></td></tr>
<tr class="separator:a4b99eee8890b03e1c3a508c24ff3b02f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e3dfe810e48d2e05f8b5e864267ea21" id="r_a5e3dfe810e48d2e05f8b5e864267ea21"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacelibcdoc.html#abb349a8d9c0b8304470646b4080142c3">result_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structlibcdoc_1_1PKCS11Backend.html#a5e3dfe810e48d2e05f8b5e864267ea21">sign</a> (std::vector&lt; uint8_t &gt; &amp;dst, <a class="el" href="structlibcdoc_1_1CryptoBackend.html#aef9aa7d17f928e221df06969cb073615">HashAlgorithm</a> algorithm, const std::vector&lt; uint8_t &gt; &amp;digest, unsigned int idx) override</td></tr>
<tr class="memdesc:a5e3dfe810e48d2e05f8b5e864267ea21"><td class="mdescLeft">&#160;</td><td class="mdescRight">sign Sign message with given algorithm  <br /></td></tr>
<tr class="separator:a5e3dfe810e48d2e05f8b5e864267ea21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_structlibcdoc_1_1CryptoBackend"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_structlibcdoc_1_1CryptoBackend')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="structlibcdoc_1_1CryptoBackend.html">libcdoc::CryptoBackend</a></td></tr>
<tr class="memitem:a40151806de1002b1de704306dca4accd inherit pub_methods_structlibcdoc_1_1CryptoBackend" id="r_a40151806de1002b1de704306dca4accd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structlibcdoc_1_1CryptoBackend.html#a40151806de1002b1de704306dca4accd">CryptoBackend</a> ()=default</td></tr>
<tr class="separator:a40151806de1002b1de704306dca4accd inherit pub_methods_structlibcdoc_1_1CryptoBackend"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e677022566d032ee7eef78b2aa703ba inherit pub_methods_structlibcdoc_1_1CryptoBackend" id="r_a2e677022566d032ee7eef78b2aa703ba"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structlibcdoc_1_1CryptoBackend.html#a2e677022566d032ee7eef78b2aa703ba">~CryptoBackend</a> () noexcept=default</td></tr>
<tr class="separator:a2e677022566d032ee7eef78b2aa703ba inherit pub_methods_structlibcdoc_1_1CryptoBackend"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65ad684e9250e01d464a5da692c8ee2d inherit pub_methods_structlibcdoc_1_1CryptoBackend" id="r_a65ad684e9250e01d464a5da692c8ee2d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structlibcdoc_1_1CryptoBackend.html#a65ad684e9250e01d464a5da692c8ee2d">CryptoBackend</a> (const <a class="el" href="structlibcdoc_1_1CryptoBackend.html">CryptoBackend</a> &amp;)=delete</td></tr>
<tr class="separator:a65ad684e9250e01d464a5da692c8ee2d inherit pub_methods_structlibcdoc_1_1CryptoBackend"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72d12f9dbd77f731abe69f1b6ccd9d55 inherit pub_methods_structlibcdoc_1_1CryptoBackend" id="r_a72d12f9dbd77f731abe69f1b6ccd9d55"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structlibcdoc_1_1CryptoBackend.html">CryptoBackend</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structlibcdoc_1_1CryptoBackend.html#a72d12f9dbd77f731abe69f1b6ccd9d55">operator=</a> (const <a class="el" href="structlibcdoc_1_1CryptoBackend.html">CryptoBackend</a> &amp;)=delete</td></tr>
<tr class="separator:a72d12f9dbd77f731abe69f1b6ccd9d55 inherit pub_methods_structlibcdoc_1_1CryptoBackend"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abaf0463e392aff4260f9ddf9f82c3a9a inherit pub_methods_structlibcdoc_1_1CryptoBackend" id="r_abaf0463e392aff4260f9ddf9f82c3a9a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structlibcdoc_1_1CryptoBackend.html#abaf0463e392aff4260f9ddf9f82c3a9a">CDOC_DISABLE_MOVE</a> (<a class="el" href="structlibcdoc_1_1CryptoBackend.html">CryptoBackend</a>)</td></tr>
<tr class="separator:abaf0463e392aff4260f9ddf9f82c3a9a inherit pub_methods_structlibcdoc_1_1CryptoBackend"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b304b6c9b90ab538dddcb87a8c3109a inherit pub_methods_structlibcdoc_1_1CryptoBackend" id="r_a2b304b6c9b90ab538dddcb87a8c3109a"><td class="memItemLeft" align="right" valign="top">virtual std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structlibcdoc_1_1CryptoBackend.html#a2b304b6c9b90ab538dddcb87a8c3109a">getLastErrorStr</a> (<a class="el" href="namespacelibcdoc.html#abb349a8d9c0b8304470646b4080142c3">result_t</a> code) const</td></tr>
<tr class="separator:a2b304b6c9b90ab538dddcb87a8c3109a inherit pub_methods_structlibcdoc_1_1CryptoBackend"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e7fb1431ed6cf6c42071c5dace63bde inherit pub_methods_structlibcdoc_1_1CryptoBackend" id="r_a4e7fb1431ed6cf6c42071c5dace63bde"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacelibcdoc.html#abb349a8d9c0b8304470646b4080142c3">result_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structlibcdoc_1_1CryptoBackend.html#a4e7fb1431ed6cf6c42071c5dace63bde">random</a> (std::vector&lt; uint8_t &gt; &amp;dst, unsigned int size)</td></tr>
<tr class="memdesc:a4e7fb1431ed6cf6c42071c5dace63bde inherit pub_methods_structlibcdoc_1_1CryptoBackend"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fill vector with random bytes.  <br /></td></tr>
<tr class="separator:a4e7fb1431ed6cf6c42071c5dace63bde inherit pub_methods_structlibcdoc_1_1CryptoBackend"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc30e0f2c953f272e7a25c2d22f9676c inherit pub_methods_structlibcdoc_1_1CryptoBackend" id="r_acc30e0f2c953f272e7a25c2d22f9676c"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacelibcdoc.html#abb349a8d9c0b8304470646b4080142c3">result_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structlibcdoc_1_1CryptoBackend.html#acc30e0f2c953f272e7a25c2d22f9676c">deriveConcatKDF</a> (std::vector&lt; uint8_t &gt; &amp;dst, const std::vector&lt; uint8_t &gt; &amp;public_key, const std::string &amp;digest, const std::vector&lt; uint8_t &gt; &amp;algorithm_id, const std::vector&lt; uint8_t &gt; &amp;party_uinfo, const std::vector&lt; uint8_t &gt; &amp;party_vinfo, unsigned int idx)</td></tr>
<tr class="memdesc:acc30e0f2c953f272e7a25c2d22f9676c inherit pub_methods_structlibcdoc_1_1CryptoBackend"><td class="mdescLeft">&#160;</td><td class="mdescRight">Derive key by ConcatKDF algorithm.  <br /></td></tr>
<tr class="separator:acc30e0f2c953f272e7a25c2d22f9676c inherit pub_methods_structlibcdoc_1_1CryptoBackend"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85837120663e6e6ac97abbfe03c9a48f inherit pub_methods_structlibcdoc_1_1CryptoBackend" id="r_a85837120663e6e6ac97abbfe03c9a48f"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacelibcdoc.html#abb349a8d9c0b8304470646b4080142c3">result_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structlibcdoc_1_1CryptoBackend.html#a85837120663e6e6ac97abbfe03c9a48f">deriveHMACExtract</a> (std::vector&lt; uint8_t &gt; &amp;dst, const std::vector&lt; uint8_t &gt; &amp;public_key, const std::vector&lt; uint8_t &gt; &amp;salt, unsigned int idx)</td></tr>
<tr class="memdesc:a85837120663e6e6ac97abbfe03c9a48f inherit pub_methods_structlibcdoc_1_1CryptoBackend"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get CDoc2 KEK pre-master from ECC key.  <br /></td></tr>
<tr class="separator:a85837120663e6e6ac97abbfe03c9a48f inherit pub_methods_structlibcdoc_1_1CryptoBackend"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a311eafdc241358807687b30c5ce507b8 inherit pub_methods_structlibcdoc_1_1CryptoBackend" id="r_a311eafdc241358807687b30c5ce507b8"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacelibcdoc.html#abb349a8d9c0b8304470646b4080142c3">result_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structlibcdoc_1_1CryptoBackend.html#a311eafdc241358807687b30c5ce507b8">getSecret</a> (std::vector&lt; uint8_t &gt; &amp;dst, unsigned int idx)</td></tr>
<tr class="memdesc:a311eafdc241358807687b30c5ce507b8 inherit pub_methods_structlibcdoc_1_1CryptoBackend"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get secret value (either password or symmetric key) for a lock.  <br /></td></tr>
<tr class="separator:a311eafdc241358807687b30c5ce507b8 inherit pub_methods_structlibcdoc_1_1CryptoBackend"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c4916031c410ff74a608254a94f1259 inherit pub_methods_structlibcdoc_1_1CryptoBackend" id="r_a6c4916031c410ff74a608254a94f1259"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacelibcdoc.html#abb349a8d9c0b8304470646b4080142c3">result_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structlibcdoc_1_1CryptoBackend.html#a6c4916031c410ff74a608254a94f1259">getKeyMaterial</a> (std::vector&lt; uint8_t &gt; &amp;dst, const std::vector&lt; uint8_t &gt; &amp;pw_salt, int32_t kdf_iter, unsigned int idx)</td></tr>
<tr class="memdesc:a6c4916031c410ff74a608254a94f1259 inherit pub_methods_structlibcdoc_1_1CryptoBackend"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get CDoc2 key material for HKDF expansion.  <br /></td></tr>
<tr class="separator:a6c4916031c410ff74a608254a94f1259 inherit pub_methods_structlibcdoc_1_1CryptoBackend"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9234eaf06c4c600d1d4b84beb7c27dce inherit pub_methods_structlibcdoc_1_1CryptoBackend" id="r_a9234eaf06c4c600d1d4b84beb7c27dce"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structlibcdoc_1_1CryptoBackend.html#a9234eaf06c4c600d1d4b84beb7c27dce">test</a> (<a class="el" href="structlibcdoc_1_1Lock.html">libcdoc::Lock</a> &amp;lock)</td></tr>
<tr class="separator:a9234eaf06c4c600d1d4b84beb7c27dce inherit pub_methods_structlibcdoc_1_1CryptoBackend"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="inherited" name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pub_types_structlibcdoc_1_1CryptoBackend"><td colspan="2" onclick="javascript:toggleInherit('pub_types_structlibcdoc_1_1CryptoBackend')"><img src="closed.png" alt="-"/>&#160;Public Types inherited from <a class="el" href="structlibcdoc_1_1CryptoBackend.html">libcdoc::CryptoBackend</a></td></tr>
<tr class="memitem:aef9aa7d17f928e221df06969cb073615 inherit pub_types_structlibcdoc_1_1CryptoBackend" id="r_aef9aa7d17f928e221df06969cb073615"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structlibcdoc_1_1CryptoBackend.html#aef9aa7d17f928e221df06969cb073615">HashAlgorithm</a> : uint32_t { <a class="el" href="structlibcdoc_1_1CryptoBackend.html#aef9aa7d17f928e221df06969cb073615adb7e9b08e5135123ac957696714c0f7b">SHA_224</a>
, <a class="el" href="structlibcdoc_1_1CryptoBackend.html#aef9aa7d17f928e221df06969cb073615a3e15dacbc581cd9d03126df86a6bea37">SHA_256</a>
, <a class="el" href="structlibcdoc_1_1CryptoBackend.html#aef9aa7d17f928e221df06969cb073615a240b0478aebd1834b0da199a891bb8f9">SHA_384</a>
, <a class="el" href="structlibcdoc_1_1CryptoBackend.html#aef9aa7d17f928e221df06969cb073615aa178b4d963e2fd9d18a3184430d2bc6d">SHA_512</a>
 }</td></tr>
<tr class="separator:aef9aa7d17f928e221df06969cb073615 inherit pub_types_structlibcdoc_1_1CryptoBackend"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_static_attribs_structlibcdoc_1_1CryptoBackend"><td colspan="2" onclick="javascript:toggleInherit('pub_static_attribs_structlibcdoc_1_1CryptoBackend')"><img src="closed.png" alt="-"/>&#160;Static Public Attributes inherited from <a class="el" href="structlibcdoc_1_1CryptoBackend.html">libcdoc::CryptoBackend</a></td></tr>
<tr class="memitem:a24c210f70221638bfbc92e085273049b inherit pub_static_attribs_structlibcdoc_1_1CryptoBackend" id="r_a24c210f70221638bfbc92e085273049b"><td class="memItemLeft" align="right" valign="top">static constexpr int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structlibcdoc_1_1CryptoBackend.html#a24c210f70221638bfbc92e085273049b">INVALID_PARAMS</a> = -201</td></tr>
<tr class="separator:a24c210f70221638bfbc92e085273049b inherit pub_static_attribs_structlibcdoc_1_1CryptoBackend"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a16fb16b7d361e6124c34ab1ff314d8 inherit pub_static_attribs_structlibcdoc_1_1CryptoBackend" id="r_a0a16fb16b7d361e6124c34ab1ff314d8"><td class="memItemLeft" align="right" valign="top">static constexpr int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structlibcdoc_1_1CryptoBackend.html#a0a16fb16b7d361e6124c34ab1ff314d8">OPENSSL_ERROR</a> = -202</td></tr>
<tr class="separator:a0a16fb16b7d361e6124c34ab1ff314d8 inherit pub_static_attribs_structlibcdoc_1_1CryptoBackend"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5dfa9e31e8d3228dfbbf09db86115a8b inherit pub_static_attribs_structlibcdoc_1_1CryptoBackend" id="r_a5dfa9e31e8d3228dfbbf09db86115a8b"><td class="memItemLeft" align="right" valign="top">static constexpr int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structlibcdoc_1_1CryptoBackend.html#a5dfa9e31e8d3228dfbbf09db86115a8b">ECC_KEY_LEN</a> = 32</td></tr>
<tr class="separator:a5dfa9e31e8d3228dfbbf09db86115a8b inherit pub_static_attribs_structlibcdoc_1_1CryptoBackend"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A convenience class for PKCS11 based cryptographic operations. </p>
<p>It has default implementations of all <a class="el" href="structlibcdoc_1_1CryptoBackend.html" title="An authentication provider.">CryptoBackend</a> methods. Instead the user has to implement connectToKey method. The latter should find the correct private or secret key for the lock and then call either usePrivateKey or useSecretKey to load the key. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a74885b986a6a2897b3ac85ee24e5b87a" name="a74885b986a6a2897b3ac85ee24e5b87a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74885b986a6a2897b3ac85ee24e5b87a">&#9670;&#160;</a></span>PKCS11Backend()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">libcdoc::PKCS11Backend::PKCS11Backend </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>path</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Construct a new <a class="el" href="structlibcdoc_1_1PKCS11Backend.html" title="A convenience class for PKCS11 based cryptographic operations.">PKCS11Backend</a> object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">path</td><td>a path to PKCS11 library to use (usually .so or .dll depending on operating system) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a8cd9cf09516cd59c65eb0d5287d56687" name="a8cd9cf09516cd59c65eb0d5287d56687"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8cd9cf09516cd59c65eb0d5287d56687">&#9670;&#160;</a></span>~PKCS11Backend()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">libcdoc::PKCS11Backend::~PKCS11Backend </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="acfe309c8bad55fb7578b72051acd58a7" name="acfe309c8bad55fb7578b72051acd58a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acfe309c8bad55fb7578b72051acd58a7">&#9670;&#160;</a></span>connectToKey()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespacelibcdoc.html#abb349a8d9c0b8304470646b4080142c3">result_t</a> libcdoc::PKCS11Backend::connectToKey </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>priv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>loads key for encryption/decryption </p>
<p>A method to load the correct private/secret key for given capsule or receiver. The subclass implementation should call either useSecretKey or usePrivateKey with proper pin, PKCS11 label and/or id to actually load the key for subsequent cryptographic operation. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">idx</td><td>lock or recipient index (0-based) in CDoc container </td></tr>
    <tr><td class="paramname">priv</td><td>whether to connect to private or secret key </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>error code or OK </dd></dl>

<p class="reference">References <a class="el" href="namespacelibcdoc.html#a02f56a86beadde55c0814a29bfe3ed99ad95bf6265fd2fbfac86f61366299453b">libcdoc::NOT_IMPLEMENTED</a>.</p>

</div>
</div>
<a id="a64513a6ead8c69232e1285efd58ba64b" name="a64513a6ead8c69232e1285efd58ba64b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64513a6ead8c69232e1285efd58ba64b">&#9670;&#160;</a></span>decryptRSA()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespacelibcdoc.html#abb349a8d9c0b8304470646b4080142c3">result_t</a> libcdoc::PKCS11Backend::decryptRSA </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; uint8_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; uint8_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>oaep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>idx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>decryptRSA </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dst</td><td>the destination container for decrypted data </td></tr>
    <tr><td class="paramname">data</td><td>encrypted data </td></tr>
    <tr><td class="paramname">oaep</td><td>use OAEP padding </td></tr>
    <tr><td class="paramname">idx</td><td>lock index (0-based) in container </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>error code or OK </dd></dl>

<p>Reimplemented from <a class="el" href="structlibcdoc_1_1CryptoBackend.html#a3627a1e0bb180ff57e83e453c611ab77">libcdoc::CryptoBackend</a>.</p>

</div>
</div>
<a id="acd6134ab368917d7b061ff0c11b96f71" name="acd6134ab368917d7b061ff0c11b96f71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd6134ab368917d7b061ff0c11b96f71">&#9670;&#160;</a></span>deriveECDH1()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespacelibcdoc.html#abb349a8d9c0b8304470646b4080142c3">result_t</a> libcdoc::PKCS11Backend::deriveECDH1 </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; uint8_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; uint8_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>public_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>idx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Derive shared secret. </p>
<p>Derive a shared secret from private key of given lock and public key using ECDH1 algorithm. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dst</td><td>the container for shared secret </td></tr>
    <tr><td class="paramname">public_key</td><td>ECDH public key used to derive shared secret </td></tr>
    <tr><td class="paramname">idx</td><td>lock index (0-based) in container </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>error code or OK </dd></dl>

<p>Reimplemented from <a class="el" href="structlibcdoc_1_1CryptoBackend.html#ac690cb9b93c0734c6d5c54357b7cff83">libcdoc::CryptoBackend</a>.</p>

</div>
</div>
<a id="a4b99eee8890b03e1c3a508c24ff3b02f" name="a4b99eee8890b03e1c3a508c24ff3b02f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b99eee8890b03e1c3a508c24ff3b02f">&#9670;&#160;</a></span>extractHKDF()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespacelibcdoc.html#abb349a8d9c0b8304470646b4080142c3">result_t</a> libcdoc::PKCS11Backend::extractHKDF </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; uint8_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; uint8_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>salt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; uint8_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>pw_salt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>kdf_iter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>idx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get CDoc2 KEK pre-master from symmetric key. </p>
<p>Calculates KEK (Key Encryption Key) pre-master from a symmetric key (either password or key-based). The default implementation calls getKeyMaterial and performs local HKDF extract. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dst</td><td>the destination container for KEK pre-master </td></tr>
    <tr><td class="paramname">salt</td><td>the salt value for HKDF extract </td></tr>
    <tr><td class="paramname">pw_salt</td><td>the salt value for PBKDF </td></tr>
    <tr><td class="paramname">kdf_iter</td><td>the number of KDF iterations. If kdf_iter is 0, the key is plain symmetric key instead of password. </td></tr>
    <tr><td class="paramname">idx</td><td>lock or recipient index (0-based) in container </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>error code or OK </dd></dl>

<p>Reimplemented from <a class="el" href="structlibcdoc_1_1CryptoBackend.html#a42349ee8079b9aebcb9dfd0efb4f9a0e">libcdoc::CryptoBackend</a>.</p>

</div>
</div>
<a id="a17ab0ce43dc28ec18ef2c5147f3b4508" name="a17ab0ce43dc28ec18ef2c5147f3b4508"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17ab0ce43dc28ec18ef2c5147f3b4508">&#9670;&#160;</a></span>findCertificates() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="structlibcdoc_1_1PKCS11Backend_1_1Handle.html">Handle</a> &gt; libcdoc::PKCS11Backend::findCertificates </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>label</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>find all certificates with given label </p>
<p>A convenience method to fetch all certificates in all slots with given label. If the label is empty, returns all certificates. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">label</td><td>a certificate label or empty string </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a vector of handles </dd></dl>

</div>
</div>
<a id="a9e7bcd109cd8b21362a35bcfb04a1cbb" name="a9e7bcd109cd8b21362a35bcfb04a1cbb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e7bcd109cd8b21362a35bcfb04a1cbb">&#9670;&#160;</a></span>findCertificates() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="structlibcdoc_1_1PKCS11Backend_1_1Handle.html">Handle</a> &gt; libcdoc::PKCS11Backend::findCertificates </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; uint8_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>public_key</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>find all certificates for given public key </p>
<p>A convenience method to fetch all certificates in all slots with given public key. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">public_key</td><td>public key (short form) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a list of handles </dd></dl>

</div>
</div>
<a id="aa75431d2b7a367dd84fc99883667628a" name="aa75431d2b7a367dd84fc99883667628a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa75431d2b7a367dd84fc99883667628a">&#9670;&#160;</a></span>findSecretKeys()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="structlibcdoc_1_1PKCS11Backend_1_1Handle.html">Handle</a> &gt; libcdoc::PKCS11Backend::findSecretKeys </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>label</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>find all secret keys with given label </p>
<p>A convenience method to fetch all secret keys in all slots with given label. If the label is empty, returns all secret keys. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">label</td><td>a certificate label or empty string </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a vector of handles </dd></dl>

</div>
</div>
<a id="a8a25d323c8c4c0d2bed8aec9345c560f" name="a8a25d323c8c4c0d2bed8aec9345c560f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a25d323c8c4c0d2bed8aec9345c560f">&#9670;&#160;</a></span>getCertificate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibcdoc.html#abb349a8d9c0b8304470646b4080142c3">result_t</a> libcdoc::PKCS11Backend::getCertificate </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; uint8_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>val</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool &amp;&#160;</td>
          <td class="paramname"><em>rsa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>slot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; uint8_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>pin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; uint8_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>label</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>get certificate value </p>
<p>Get a certificate value given slot, label and id. Both key id and label have to match unless either one is empty. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">val</td><td>a destination container for value </td></tr>
    <tr><td class="paramname">rsa</td><td>will be set true is certificate uses RSA key </td></tr>
    <tr><td class="paramname">slot</td><td>the slot to use </td></tr>
    <tr><td class="paramname">pin</td><td>the pin code </td></tr>
    <tr><td class="paramname">id</td><td>certificate id or empty vector </td></tr>
    <tr><td class="paramname">label</td><td>certificate label or empty vector </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>error code or OK </dd></dl>

</div>
</div>
<a id="aaf49cdf8293066360fcddc7b66efa2df" name="aaf49cdf8293066360fcddc7b66efa2df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf49cdf8293066360fcddc7b66efa2df">&#9670;&#160;</a></span>getPublicKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibcdoc.html#abb349a8d9c0b8304470646b4080142c3">result_t</a> libcdoc::PKCS11Backend::getPublicKey </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; uint8_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>val</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool &amp;&#160;</td>
          <td class="paramname"><em>rsa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>slot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; uint8_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>pin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; uint8_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>label</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>get public key value </p>
<p>Get a public key value given slot, label and id. Both key id and label have to match unless either one is empty. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">val</td><td>a destination container for value </td></tr>
    <tr><td class="paramname">rsa</td><td>will be set true is public key uses RSA key </td></tr>
    <tr><td class="paramname">slot</td><td>the slot to use </td></tr>
    <tr><td class="paramname">pin</td><td>the pin code </td></tr>
    <tr><td class="paramname">id</td><td>public key id or empty vector </td></tr>
    <tr><td class="paramname">label</td><td>public key label or empty vector </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>error code or OK </dd></dl>

</div>
</div>
<a id="a5e3dfe810e48d2e05f8b5e864267ea21" name="a5e3dfe810e48d2e05f8b5e864267ea21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e3dfe810e48d2e05f8b5e864267ea21">&#9670;&#160;</a></span>sign()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespacelibcdoc.html#abb349a8d9c0b8304470646b4080142c3">result_t</a> libcdoc::PKCS11Backend::sign </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; uint8_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlibcdoc_1_1CryptoBackend.html#aef9aa7d17f928e221df06969cb073615">HashAlgorithm</a>&#160;</td>
          <td class="paramname"><em>algorithm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; uint8_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>digest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>idx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>sign Sign message with given algorithm </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dst</td><td>the destination container for signed message </td></tr>
    <tr><td class="paramname">algorithm</td><td>hashing algorithm </td></tr>
    <tr><td class="paramname">digest</td><td>a message to sign </td></tr>
    <tr><td class="paramname">idx</td><td>lock or recipient index (0-based) in container </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>error code or OK </dd></dl>

<p>Reimplemented from <a class="el" href="structlibcdoc_1_1CryptoBackend.html#abe1b3c5e4ae7d07a4c10eaa31c5a2c18">libcdoc::CryptoBackend</a>.</p>

</div>
</div>
<a id="ada4f66fba5fe24208239331fedf6ba12" name="ada4f66fba5fe24208239331fedf6ba12"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada4f66fba5fe24208239331fedf6ba12">&#9670;&#160;</a></span>usePrivateKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibcdoc.html#abb349a8d9c0b8304470646b4080142c3">result_t</a> libcdoc::PKCS11Backend::usePrivateKey </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>slot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; uint8_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>pin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; uint8_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>label</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>loads private key </p>
<p>Opens slot, logs in with pin and finds the correct private key. Both key id and label have to match unless either one is empty. If the key is found, it is loaded internally for subsequent cryptographic operations. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">slot</td><td>a PKCS11 slot to use </td></tr>
    <tr><td class="paramname">pin</td><td>a user pin </td></tr>
    <tr><td class="paramname">id</td><td>the key id </td></tr>
    <tr><td class="paramname">label</td><td>the key label </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>error code or OK </dd></dl>

</div>
</div>
<a id="a6895f5e16312d11c19bac659b229c309" name="a6895f5e16312d11c19bac659b229c309"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6895f5e16312d11c19bac659b229c309">&#9670;&#160;</a></span>usePSS()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="namespacelibcdoc.html#abb349a8d9c0b8304470646b4080142c3">result_t</a> libcdoc::PKCS11Backend::usePSS </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>idx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>whether to use PSS RSA padding </p>
<p>A subclass should overwrite this to inform the backend about the correct padding. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">idx</td><td>a lock idx </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if PSS padding is sued </dd></dl>

</div>
</div>
<a id="ac4bcd34cdd3463087935cf7c78a0b80c" name="ac4bcd34cdd3463087935cf7c78a0b80c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4bcd34cdd3463087935cf7c78a0b80c">&#9670;&#160;</a></span>useSecretKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibcdoc.html#abb349a8d9c0b8304470646b4080142c3">result_t</a> libcdoc::PKCS11Backend::useSecretKey </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>slot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; uint8_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>pin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; uint8_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>label</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>load secret key </p>
<p>Opens slot, logs in with pin and finds the correct secret key. Both key id and label have to match unless either one is empty. If the key is found, it is loaded internally for subsequent cryptographic operations. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">slot</td><td>a PKCS11 slot to use </td></tr>
    <tr><td class="paramname">pin</td><td>a user pin </td></tr>
    <tr><td class="paramname">id</td><td>the key id or empty vector </td></tr>
    <tr><td class="paramname">label</td><td>the key label or empty string </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>error code or OK </dd></dl>

</div>
</div>
<hr/>The documentation for this struct was generated from the following file:<ul>
<li><b>PKCS11Backend.h</b></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacelibcdoc.html">libcdoc</a></li><li class="navelem"><a class="el" href="structlibcdoc_1_1PKCS11Backend.html">PKCS11Backend</a></li>
    <li class="footer">Generated on Tue Sep 16 2025 13:17:06 for libcdoc by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
